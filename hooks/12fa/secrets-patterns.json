{
  "patterns": [
    {
      "name": "anthropic_api_key",
      "regex": "sk-ant-[a-zA-Z0-9_-]{95,}",
      "severity": "critical",
      "description": "Anthropic API key detected",
      "recommendation": "Use ANTHROPIC_API_KEY environment variable"
    },
    {
      "name": "openai_api_key",
      "regex": "sk-[a-zA-Z0-9]{20,}",
      "severity": "critical",
      "description": "OpenAI API key detected",
      "recommendation": "Use OPENAI_API_KEY environment variable"
    },
    {
      "name": "github_token",
      "regex": "ghp_[a-zA-Z0-9]{30,40}",
      "severity": "critical",
      "description": "GitHub Personal Access Token detected",
      "recommendation": "Use GITHUB_TOKEN environment variable"
    },
    {
      "name": "github_oauth",
      "regex": "gho_[a-zA-Z0-9]{30,40}",
      "severity": "critical",
      "description": "GitHub OAuth token detected",
      "recommendation": "Use secure GitHub OAuth flow"
    },
    {
      "name": "github_app_token",
      "regex": "ghs_[a-zA-Z0-9]{36}",
      "severity": "critical",
      "description": "GitHub App token detected",
      "recommendation": "Use secure GitHub App authentication"
    },
    {
      "name": "aws_access_key",
      "regex": "AKIA[0-9A-Z]{16}",
      "severity": "critical",
      "description": "AWS Access Key ID detected",
      "recommendation": "Use AWS IAM roles or AWS_ACCESS_KEY_ID environment variable"
    },
    {
      "name": "aws_secret_key",
      "regex": "aws_secret_access_key[\\s]*[=:][\\s]*['\"]?([a-zA-Z0-9/+=]{40})['\"]?",
      "severity": "critical",
      "description": "AWS Secret Access Key detected",
      "recommendation": "Use AWS IAM roles or AWS_SECRET_ACCESS_KEY environment variable"
    },
    {
      "name": "azure_connection_string",
      "regex": "DefaultEndpointsProtocol=https;AccountName=[^;]+;AccountKey=[a-zA-Z0-9+/=]{88}",
      "severity": "critical",
      "description": "Azure Storage connection string detected",
      "recommendation": "Use Azure Key Vault or managed identities"
    },
    {
      "name": "gcp_service_account",
      "regex": "\"type\":\\s*\"service_account\"",
      "severity": "critical",
      "description": "GCP Service Account JSON detected",
      "recommendation": "Use GCP Secret Manager or GOOGLE_APPLICATION_CREDENTIALS path"
    },
    {
      "name": "slack_webhook",
      "regex": "https://hooks\\.slack\\.com/services/T[a-zA-Z0-9_]+/B[a-zA-Z0-9_]+/[a-zA-Z0-9_]+",
      "severity": "high",
      "description": "Slack Webhook URL detected",
      "recommendation": "Use SLACK_WEBHOOK_URL environment variable"
    },
    {
      "name": "slack_api_token",
      "regex": "xox[baprs]-[0-9]{10,12}-[0-9]{10,12}-[a-zA-Z0-9]{24,}",
      "severity": "critical",
      "description": "Slack API token detected",
      "recommendation": "Use SLACK_TOKEN environment variable"
    },
    {
      "name": "stripe_api_key",
      "regex": "sk_live_[a-zA-Z0-9]{24,}",
      "severity": "critical",
      "description": "Stripe Live API key detected",
      "recommendation": "Use STRIPE_SECRET_KEY environment variable"
    },
    {
      "name": "twilio_api_key",
      "regex": "SK[a-z0-9]{32}",
      "severity": "critical",
      "description": "Twilio API key detected",
      "recommendation": "Use TWILIO_API_KEY environment variable"
    },
    {
      "name": "jwt_token",
      "regex": "eyJ[a-zA-Z0-9_-]{10,}\\.[a-zA-Z0-9_-]{10,}\\.[a-zA-Z0-9_-]{10,}",
      "severity": "high",
      "description": "JWT token detected",
      "recommendation": "Store JWTs in secure HTTP-only cookies or secure storage"
    },
    {
      "name": "password_field",
      "regex": "(password|passwd|pwd)[\\s]*[=:][\\s]*['\"]([^'\"\\s]{8,})['\"]",
      "severity": "critical",
      "description": "Password in plain text detected",
      "recommendation": "Use PASSWORD or secure credential storage"
    },
    {
      "name": "private_key_header",
      "regex": "-----BEGIN (RSA |EC |DSA |OPENSSH )?PRIVATE KEY-----",
      "severity": "critical",
      "description": "Private key detected",
      "recommendation": "Use SSH agent or secure key management system"
    },
    {
      "name": "database_connection_string",
      "regex": "(postgres|postgresql|mysql|mongodb|mongo|redis)://[^\\s:@]+:[^\\s@]+@[^\\s/]+",
      "severity": "critical",
      "description": "Database connection string with credentials detected",
      "recommendation": "Use DATABASE_URL environment variable without credentials in code"
    },
    {
      "name": "basic_auth",
      "regex": "Authorization[\\s]*:[\\s]*Basic[\\s]+[a-zA-Z0-9+/=]{20,}",
      "severity": "high",
      "description": "Basic authentication header detected",
      "recommendation": "Use secure authentication tokens"
    },
    {
      "name": "bearer_token",
      "regex": "Authorization[\\s]*:[\\s]*Bearer[\\s]+[a-zA-Z0-9_-]{20,}",
      "severity": "high",
      "description": "Bearer token detected",
      "recommendation": "Use secure token storage and rotation"
    },
    {
      "name": "api_key_generic",
      "regex": "(api[_-]?key|apikey|api[_-]?secret)[\\s]*[=:][\\s]*['\"]([a-zA-Z0-9_-]{16,})['\"]",
      "severity": "high",
      "description": "Generic API key detected",
      "recommendation": "Use environment variables for API keys"
    }
  ],
  "whitelisted_patterns": [
    "example\\.com",
    "localhost",
    "127\\.0\\.0\\.1",
    "test[_-]?(key|token|secret)",
    "dummy[_-]?(key|token|secret)",
    "fake[_-]?(key|token|secret)",
    "mock[_-]?(key|token|secret)"
  ],
  "config": {
    "block_on_detection": true,
    "redact_in_logs": true,
    "audit_violations": true,
    "max_scan_size": 1048576,
    "performance_timeout_ms": 10
  }
}
