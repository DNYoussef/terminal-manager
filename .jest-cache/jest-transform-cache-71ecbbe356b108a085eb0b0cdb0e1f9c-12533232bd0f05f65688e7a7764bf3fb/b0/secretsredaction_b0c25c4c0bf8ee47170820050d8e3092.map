{"version":3,"names":["cov_259dpoh0rz","actualCoverage","fs","s","require","path","SecretsRedactor","constructor","patternsPath","b","f","join","__dirname","patterns","whitelistedPatterns","config","violationLog","loadPatterns","data","readFileSync","JSON","parse","map","pattern","compiledRegex","RegExp","regex","whitelisted_patterns","error","console","message","Error","reloadPatterns","isWhitelisted","value","stringify","some","test","scanForSecrets","startTime","Date","now","detections","scanValue","String","max_scan_size","length","matches","match","push","name","severity","description","recommendation","matchCount","sample","redactMatch","scanTime","performance_timeout_ms","warn","substring","validateNoSecrets","key","violation","timestamp","toISOString","d","blocked","block_on_detection","audit_violations","auditViolation","errorMessage","formatErrorMessage","criticalCount","filter","highCount","forEach","detection","index","toUpperCase","logDir","logFile","existsSync","mkdirSync","recursive","logEntry","appendFileSync","getViolationStats","stats","total","bySeverity","byPattern","recent","slice","clearViolationLog","addCustomPattern","compiledPattern","redactSecrets","redactedValue","replace","instance","getRedactorInstance","module","exports"],"sources":["secrets-redaction.js"],"sourcesContent":["/**\n * Secrets Redaction Module\n *\n * Detects and prevents storage of secrets in memory system.\n * Part of 12-Factor App compliance (Quick Win #2).\n */\n\nconst fs = require('fs');\nconst path = require('path');\n\nclass SecretsRedactor {\n  constructor(patternsPath = null) {\n    this.patternsPath = patternsPath || path.join(__dirname, 'secrets-patterns.json');\n    this.patterns = [];\n    this.whitelistedPatterns = [];\n    this.config = {};\n    this.violationLog = [];\n    this.loadPatterns();\n  }\n\n  /**\n   * Load secret patterns from configuration file\n   */\n  loadPatterns() {\n    try {\n      const data = fs.readFileSync(this.patternsPath, 'utf8');\n      const config = JSON.parse(data);\n\n      // Compile regex patterns for performance\n      this.patterns = config.patterns.map(pattern => ({\n        ...pattern,\n        compiledRegex: new RegExp(pattern.regex, 'gi')\n      }));\n\n      // Compile whitelist patterns\n      this.whitelistedPatterns = (config.whitelisted_patterns || []).map(\n        pattern => new RegExp(pattern, 'i')\n      );\n\n      this.config = config.config || {};\n\n      return true;\n    } catch (error) {\n      console.error('Failed to load secrets patterns:', error.message);\n      throw new Error(`Secrets redaction initialization failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Reload patterns from file (useful for dynamic updates)\n   */\n  reloadPatterns() {\n    this.patterns = [];\n    this.whitelistedPatterns = [];\n    this.loadPatterns();\n  }\n\n  /**\n   * Check if value is whitelisted (test data, examples, etc.)\n   */\n  isWhitelisted(value) {\n    if (typeof value !== 'string') {\n      value = JSON.stringify(value);\n    }\n\n    return this.whitelistedPatterns.some(pattern => pattern.test(value));\n  }\n\n  /**\n   * Scan value for secrets\n   * @param {string|object} value - Value to scan\n   * @returns {Array} Array of detected secrets\n   */\n  scanForSecrets(value) {\n    const startTime = Date.now();\n    const detections = [];\n\n    // Convert to string for scanning\n    let scanValue = value;\n    if (typeof value === 'object') {\n      scanValue = JSON.stringify(value, null, 2);\n    } else if (typeof value !== 'string') {\n      scanValue = String(value);\n    }\n\n    // Check size limit\n    if (this.config.max_scan_size && scanValue.length > this.config.max_scan_size) {\n      throw new Error(`Value exceeds maximum scan size of ${this.config.max_scan_size} bytes`);\n    }\n\n    // Skip if whitelisted\n    if (this.isWhitelisted(scanValue)) {\n      return detections;\n    }\n\n    // Scan against all patterns\n    for (const pattern of this.patterns) {\n      const matches = scanValue.match(pattern.compiledRegex);\n\n      if (matches && matches.length > 0) {\n        detections.push({\n          name: pattern.name,\n          severity: pattern.severity,\n          description: pattern.description,\n          recommendation: pattern.recommendation,\n          matchCount: matches.length,\n          // Only include first match snippet (redacted)\n          sample: this.redactMatch(matches[0])\n        });\n      }\n    }\n\n    // Check performance timeout\n    const scanTime = Date.now() - startTime;\n    if (this.config.performance_timeout_ms && scanTime > this.config.performance_timeout_ms) {\n      console.warn(`Secret scan exceeded timeout: ${scanTime}ms > ${this.config.performance_timeout_ms}ms`);\n    }\n\n    return detections;\n  }\n\n  /**\n   * Redact a matched secret for logging\n   */\n  redactMatch(match) {\n    if (match.length <= 8) {\n      return '***REDACTED***';\n    }\n    return match.substring(0, 4) + '***REDACTED***' + match.substring(match.length - 4);\n  }\n\n  /**\n   * Validate that no secrets are present in value\n   * @param {string} key - Memory key\n   * @param {any} value - Value to validate\n   * @throws {Error} If secrets are detected\n   * @returns {boolean} True if validation passes\n   */\n  validateNoSecrets(key, value) {\n    const detections = this.scanForSecrets(value);\n\n    if (detections.length > 0) {\n      // Log violation\n      const violation = {\n        timestamp: new Date().toISOString(),\n        key,\n        detections: detections.map(d => ({\n          name: d.name,\n          severity: d.severity,\n          description: d.description\n        })),\n        blocked: this.config.block_on_detection\n      };\n\n      this.violationLog.push(violation);\n\n      // Audit if enabled\n      if (this.config.audit_violations) {\n        this.auditViolation(violation);\n      }\n\n      // Block if configured\n      if (this.config.block_on_detection) {\n        const errorMessage = this.formatErrorMessage(detections);\n        throw new Error(errorMessage);\n      }\n\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Format user-friendly error message\n   */\n  formatErrorMessage(detections) {\n    const criticalCount = detections.filter(d => d.severity === 'critical').length;\n    const highCount = detections.filter(d => d.severity === 'high').length;\n\n    let message = 'ðŸ”’ SECRET DETECTED - Storage blocked for security!\\n\\n';\n    message += `Found ${detections.length} potential secret(s):\\n`;\n\n    detections.forEach((detection, index) => {\n      message += `\\n${index + 1}. ${detection.description}\\n`;\n      message += `   Severity: ${detection.severity.toUpperCase()}\\n`;\n      message += `   âœ… ${detection.recommendation}\\n`;\n    });\n\n    message += '\\nðŸ“š Best Practice: Store secrets in environment variables or secure vaults.\\n';\n    message += '   Never commit secrets to version control or memory storage.\\n';\n\n    return message;\n  }\n\n  /**\n   * Audit violation to log file\n   */\n  auditViolation(violation) {\n    try {\n      const logDir = path.join(__dirname, '../../logs/12fa');\n      const logFile = path.join(logDir, 'secrets-violations.log');\n\n      // Create log directory if it doesn't exist\n      if (!fs.existsSync(logDir)) {\n        fs.mkdirSync(logDir, { recursive: true });\n      }\n\n      // Append to log file\n      const logEntry = JSON.stringify(violation) + '\\n';\n      fs.appendFileSync(logFile, logEntry, 'utf8');\n    } catch (error) {\n      console.error('Failed to audit violation:', error.message);\n    }\n  }\n\n  /**\n   * Get violation statistics\n   */\n  getViolationStats() {\n    const stats = {\n      total: this.violationLog.length,\n      bySeverity: {},\n      byPattern: {},\n      recent: this.violationLog.slice(-10)\n    };\n\n    this.violationLog.forEach(violation => {\n      violation.detections.forEach(detection => {\n        // Count by severity\n        stats.bySeverity[detection.severity] =\n          (stats.bySeverity[detection.severity] || 0) + 1;\n\n        // Count by pattern name\n        stats.byPattern[detection.name] =\n          (stats.byPattern[detection.name] || 0) + 1;\n      });\n    });\n\n    return stats;\n  }\n\n  /**\n   * Clear violation log\n   */\n  clearViolationLog() {\n    this.violationLog = [];\n  }\n\n  /**\n   * Add custom pattern at runtime\n   */\n  addCustomPattern(pattern) {\n    const compiledPattern = {\n      ...pattern,\n      compiledRegex: new RegExp(pattern.regex, 'gi')\n    };\n    this.patterns.push(compiledPattern);\n  }\n\n  /**\n   * Redact secrets from value (replace with [REDACTED])\n   */\n  redactSecrets(value) {\n    let redactedValue = value;\n\n    if (typeof value === 'object') {\n      redactedValue = JSON.stringify(value, null, 2);\n    } else if (typeof value !== 'string') {\n      redactedValue = String(value);\n    }\n\n    for (const pattern of this.patterns) {\n      redactedValue = redactedValue.replace(pattern.compiledRegex, '[REDACTED]');\n    }\n\n    return redactedValue;\n  }\n}\n\n// Export singleton instance\nlet instance = null;\n\nfunction getRedactorInstance(patternsPath = null) {\n  if (!instance) {\n    instance = new SecretsRedactor(patternsPath);\n  }\n  return instance;\n}\n\nmodule.exports = {\n  SecretsRedactor,\n  getRedactorInstance,\n  validateNoSecrets: (key, value) => {\n    return getRedactorInstance().validateNoSecrets(key, value);\n  },\n  scanForSecrets: (value) => {\n    return getRedactorInstance().scanForSecrets(value);\n  },\n  redactSecrets: (value) => {\n    return getRedactorInstance().redactSecrets(value);\n  }\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}