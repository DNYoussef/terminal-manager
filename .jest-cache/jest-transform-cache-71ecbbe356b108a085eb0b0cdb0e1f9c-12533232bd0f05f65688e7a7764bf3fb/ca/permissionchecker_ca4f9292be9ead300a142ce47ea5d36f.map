{"version":3,"names":["cov_8ku76ba7l","actualCoverage","crypto","s","require","PermissionCache","constructor","ttlMinutes","b","f","cache","Map","ttlMs","maxSize","_getCacheKey","agentId","operation","get","key","entry","now","Date","expiresAt","delete","lastAccess","allowed","set","size","_evictOldest","invalidateAgent","keysToDelete","keys","startsWith","push","forEach","clear","getStats","activeEntries","expiredEntries","values","totalEntries","entriesToEvict","Math","floor","entries","Array","from","map","value","sort","a","i","length","permissionCache","checkPermission","rbacRules","startTime","process","hrtime","bigint","cachedResult","endTime","durationMs","Number","console","log","toFixed","_performPermissionCheck","action","resource","split","allowed_tools","includes","path_scopes","scope","api_access","module","exports","invalidateAgentPermissions","clearPermissionCache","getPermissionCacheStats"],"sources":["permission-checker.js"],"sourcesContent":["/**\r\n * Permission Checker with In-Memory Cache\r\n * Provides fast RBAC permission validation with 1-minute TTL cache\r\n *\r\n * Performance target: <0.1ms for cached permission checks\r\n * Cache strategy: In-memory LRU with automatic expiration\r\n */\r\n\r\nconst crypto = require('crypto');\r\n\r\nclass PermissionCache {\r\n  constructor(ttlMinutes = 1) {\r\n    this.cache = new Map();\r\n    this.ttlMs = ttlMinutes * 60 * 1000;\r\n    this.maxSize = 1000; // LRU eviction threshold\r\n  }\r\n\r\n  /**\r\n   * Generate cache key for permission check\r\n   * @param {string} agentId - Agent identifier\r\n   * @param {string} operation - Operation being checked (e.g., 'read:file', 'execute:bash')\r\n   * @returns {string} Cache key\r\n   */\r\n  _getCacheKey(agentId, operation) {\r\n    return `${agentId}:${operation}`;\r\n  }\r\n\r\n  /**\r\n   * Get cached permission result\r\n   * @param {string} agentId - Agent identifier\r\n   * @param {string} operation - Operation being checked\r\n   * @returns {boolean|null} Permission result or null if cache miss\r\n   */\r\n  get(agentId, operation) {\r\n    const key = this._getCacheKey(agentId, operation);\r\n    const entry = this.cache.get(key);\r\n\r\n    if (!entry) {\r\n      return null; // Cache miss\r\n    }\r\n\r\n    const now = Date.now();\r\n    if (now >= entry.expiresAt) {\r\n      // Expired - remove from cache\r\n      this.cache.delete(key);\r\n      return null;\r\n    }\r\n\r\n    // Update access time for LRU\r\n    entry.lastAccess = now;\r\n    return entry.allowed;\r\n  }\r\n\r\n  /**\r\n   * Set cached permission result\r\n   * @param {string} agentId - Agent identifier\r\n   * @param {string} operation - Operation being checked\r\n   * @param {boolean} allowed - Permission result\r\n   */\r\n  set(agentId, operation, allowed) {\r\n    const key = this._getCacheKey(agentId, operation);\r\n    const now = Date.now();\r\n\r\n    this.cache.set(key, {\r\n      allowed,\r\n      expiresAt: now + this.ttlMs,\r\n      lastAccess: now\r\n    });\r\n\r\n    // LRU eviction if cache too large\r\n    if (this.cache.size > this.maxSize) {\r\n      this._evictOldest();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Invalidate cache for specific agent (e.g., after permission update)\r\n   * @param {string} agentId - Agent identifier\r\n   */\r\n  invalidateAgent(agentId) {\r\n    const keysToDelete = [];\r\n    for (const key of this.cache.keys()) {\r\n      if (key.startsWith(`${agentId}:`)) {\r\n        keysToDelete.push(key);\r\n      }\r\n    }\r\n    keysToDelete.forEach(key => this.cache.delete(key));\r\n  }\r\n\r\n  /**\r\n   * Clear entire cache\r\n   */\r\n  clear() {\r\n    this.cache.clear();\r\n  }\r\n\r\n  /**\r\n   * Get cache statistics\r\n   * @returns {object} Cache stats\r\n   */\r\n  getStats() {\r\n    const now = Date.now();\r\n    let activeEntries = 0;\r\n    let expiredEntries = 0;\r\n\r\n    for (const entry of this.cache.values()) {\r\n      if (now >= entry.expiresAt) {\r\n        expiredEntries++;\r\n      } else {\r\n        activeEntries++;\r\n      }\r\n    }\r\n\r\n    return {\r\n      totalEntries: this.cache.size,\r\n      activeEntries,\r\n      expiredEntries,\r\n      maxSize: this.maxSize,\r\n      ttlMs: this.ttlMs\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Evict oldest entries (LRU)\r\n   * @private\r\n   */\r\n  _evictOldest() {\r\n    const entriesToEvict = Math.floor(this.maxSize * 0.1); // Evict 10%\r\n    const entries = Array.from(this.cache.entries())\r\n      .map(([key, value]) => ({ key, ...value }))\r\n      .sort((a, b) => a.lastAccess - b.lastAccess);\r\n\r\n    for (let i = 0; i < entriesToEvict && i < entries.length; i++) {\r\n      this.cache.delete(entries[i].key);\r\n    }\r\n  }\r\n}\r\n\r\n// Global cache instance\r\nconst permissionCache = new PermissionCache(1); // 1-minute TTL\r\n\r\n/**\r\n * Check if agent has permission for operation (with caching)\r\n * @param {string} agentId - Agent identifier\r\n * @param {string} operation - Operation to check\r\n * @param {object} rbacRules - RBAC rules for agent (from database/registry)\r\n * @returns {boolean} Whether operation is allowed\r\n */\r\nfunction checkPermission(agentId, operation, rbacRules) {\r\n  const startTime = process.hrtime.bigint();\r\n\r\n  // Check cache first\r\n  const cachedResult = permissionCache.get(agentId, operation);\r\n  if (cachedResult !== null) {\r\n    const endTime = process.hrtime.bigint();\r\n    const durationMs = Number(endTime - startTime) / 1_000_000;\r\n    console.log(`[PermissionCache] HIT for ${agentId}:${operation} (${durationMs.toFixed(3)}ms)`);\r\n    return cachedResult;\r\n  }\r\n\r\n  // Cache miss - perform actual permission check\r\n  const allowed = _performPermissionCheck(operation, rbacRules);\r\n\r\n  // Store in cache\r\n  permissionCache.set(agentId, operation, allowed);\r\n\r\n  const endTime = process.hrtime.bigint();\r\n  const durationMs = Number(endTime - startTime) / 1_000_000;\r\n  console.log(`[PermissionCache] MISS for ${agentId}:${operation} (${durationMs.toFixed(3)}ms)`);\r\n\r\n  return allowed;\r\n}\r\n\r\n/**\r\n * Actual permission checking logic (uncached)\r\n * @param {string} operation - Operation to check\r\n * @param {object} rbacRules - RBAC rules\r\n * @returns {boolean} Whether operation is allowed\r\n * @private\r\n */\r\nfunction _performPermissionCheck(operation, rbacRules) {\r\n  if (!rbacRules) {\r\n    return false; // Default deny\r\n  }\r\n\r\n  const [action, resource] = operation.split(':');\r\n\r\n  // Check allowed_tools\r\n  if (rbacRules.allowed_tools) {\r\n    if (rbacRules.allowed_tools.includes('*')) {\r\n      return true; // Wildcard access\r\n    }\r\n    if (rbacRules.allowed_tools.includes(resource)) {\r\n      return true;\r\n    }\r\n  }\r\n\r\n  // Check path_scopes for file operations\r\n  if (action === 'read' || action === 'write' || action === 'execute') {\r\n    if (rbacRules.path_scopes) {\r\n      // Simple prefix matching for demonstration\r\n      // In production, use proper path resolution\r\n      for (const scope of rbacRules.path_scopes) {\r\n        if (resource.startsWith(scope)) {\r\n          return true;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // Check api_access for API operations\r\n  if (action === 'api' && rbacRules.api_access) {\r\n    if (rbacRules.api_access.includes('*')) {\r\n      return true;\r\n    }\r\n    if (rbacRules.api_access.includes(resource)) {\r\n      return true;\r\n    }\r\n  }\r\n\r\n  return false; // Default deny\r\n}\r\n\r\nmodule.exports = {\r\n  checkPermission,\r\n  invalidateAgentPermissions: (agentId) => permissionCache.invalidateAgent(agentId),\r\n  clearPermissionCache: () => permissionCache.clear(),\r\n  getPermissionCacheStats: () => permissionCache.getStats(),\r\n  permissionCache // Export for testing\r\n};\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}